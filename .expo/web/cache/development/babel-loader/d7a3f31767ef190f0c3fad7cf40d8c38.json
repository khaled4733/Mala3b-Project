{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport React, { useState, useEffect } from \"react\";\nimport Logo from \"../assets/2511582.jpg\";\nimport { deleteFStadium, getFStadium } from \"../db/Stadium/Football\";\nimport { getUserUId } from \"../db/Auth\";\nimport { addUsersToDocuments, updateFootball, test, getUsers, updateUser } from \"../db/User\";\nimport { getBStadium } from \"../db/Stadium/Basketball\";\nimport { getTStadium } from \"../db/Stadium/Tennis\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Payment(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n  var currentUserId;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      name = _useState2[0],\n      setName = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      cardnumber = _useState4[0],\n      setCardNumber = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      cvv = _useState6[0],\n      setCVV = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      date = _useState8[0],\n      setDate = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      Fstadium = _useState10[0],\n      setFStadium = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      Bstadium = _useState12[0],\n      setBStadium = _useState12[1];\n\n  var _useState13 = useState([]),\n      _useState14 = _slicedToArray(_useState13, 2),\n      Tstadium = _useState14[0],\n      setTStadium = _useState14[1];\n\n  var currentFStadPrice;\n  var currentBStadPrice;\n  var currentTStadPrice;\n  var stadName = route.params.stadName;\n  useEffect(function () {\n    getUserUId().then(function (userId) {\n      currentUserId = userId;\n    });\n  }, []);\n  useEffect(function () {\n    getFStadium().then(function (data) {\n      setFStadium(data);\n    });\n  }, []);\n  useEffect(function () {\n    getBStadium().then(function (data) {\n      setBStadium(data);\n    });\n  }, []);\n  useEffect(function () {\n    getTStadium().then(function (data) {\n      setTStadium(data);\n    });\n  }, []);\n\n  var Handler = function Handler() {\n    console.log(\"here in paymethod\");\n    getFStadium().then(function (data) {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].name === stadName) {\n          console.log(\"Fstad name in db is \" + data[i].name);\n          console.log(\"Fstad price in db is \" + data[i].price);\n          currentFStadPrice = data[i].price;\n          console.log(\"Fstad price locally is \" + currentFStadPrice);\n        }\n      }\n    });\n    getBStadium().then(function (data) {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].name === stadName) {\n          console.log(\"Bstad name in db is \" + data[i].name);\n          console.log(\"Bstad price in db is \" + data[i].price);\n          currentBStadPrice = data[i].price;\n          console.log(\"Bstad price locally is \" + currentFStadPrice);\n        }\n      }\n    });\n    getTStadium().then(function (data) {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].name === stadName) {\n          console.log(\"Tstad name in db is \" + data[i].name);\n          console.log(\"Tstad price in db is \" + data[i].price);\n          currentTStadPrice = data[i].price;\n          console.log(\"Tstad price locally is \" + currentFStadPrice);\n        }\n      }\n    });\n    getUsers().then(function (users) {\n      getUserUId().then(function (userId) {\n        console.log(\"inside getUsers()\");\n        console.log(users);\n\n        for (var i = 0; i < users.length; i++) {\n          console.log(\"should be printed\" + users.length + \" times\");\n\n          if (userId == users[i].id) {\n            console.log(\"userId == users[i].id is true\");\n\n            for (var j = 0; j < Fstadium.length; j++) {\n              if (Fstadium[j].name !== undefined) {\n                if (stadName === Fstadium[j].name) {\n                  if (currentFStadPrice > users[i].balance) {\n                    console.log(\"Fstadium[j] before pop\", Fstadium[j].state);\n                    alert(\"you dont have enough money\");\n                    Fstadium[j].state.pop();\n                    console.log(\"Fstadium[j] after pop\", Fstadium[j].state);\n                    updateFootball(Fstadium[i]);\n                    navigation.goBack();\n                    break;\n                  } else {\n                    console.log(\"currentFStadPrice is : \", currentFStadPrice);\n                    console.log(\"users[i].balance is : \", users[i].balance);\n                    users[i].balance = users[i].balance - currentFStadPrice;\n                    updateUser(users[i]).then(function () {\n                      return alert(\"user's balance has been updated\");\n                    });\n                    navigation.goBack();\n                  }\n                }\n              } else if (stadName === Bstadium[i].name) {\n                if (currentBStadPrice > users[i].balance) {\n                  alert(\"you dont have enough money\");\n                  Bstadium[j].state.pop();\n                  updateBasketball(Bstadium[j]);\n                  navigation.goBack();\n                  break;\n                } else {\n                  console.log(currentBStadPrice);\n                  users[i].balance = users[i].balance - currentBStadPrice;\n                  updateUser(users[i]).then(function () {\n                    return alert(\"user's balance has been updated\");\n                  });\n                  navigation.goBack();\n                }\n              } else if (stadName === Tstadium[j].name) {\n                if (currentTStadPrice > users[i].balance) {\n                  alert(\"you dont have enough money\");\n                  Tstadium[j].state.pop();\n                  updateTennis(Tstadium[j]);\n                  navigation.goBack();\n                  break;\n                } else {\n                  console.log(currentTStadPrice);\n                  users[i].balance = users[i].balance - currentTStadPrice;\n                  updateUser(users[i]).then(function () {\n                    return alert(\"user's balance has been updated\");\n                  });\n                  navigation.goBack();\n                }\n              }\n            }\n          }\n        }\n      });\n    });\n  };\n\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(View, {\n      style: styles.screen,\n      children: _jsx(Image, {\n        source: Logo,\n        style: styles.image\n      })\n    }), _jsxs(View, {\n      style: styles.format,\n      children: [_jsx(TextInput, {\n        style: styles.input,\n        placeholder: \"Card Name\",\n        onChangeText: setName,\n        keyboardType: \"default\"\n      }), _jsx(TextInput, {\n        style: styles.input,\n        placeholder: \"Card Number\",\n        onChangeText: setCardNumber,\n        keyboardType: \"numeric\"\n      }), _jsx(TextInput, {\n        style: styles.input,\n        placeholder: \"MM/YY\",\n        onChangeText: setDate,\n        keyboardType: \"default\"\n      }), _jsx(TextInput, {\n        style: styles.input,\n        placeholder: \"CVV\",\n        onChangeText: setCVV,\n        keyboardType: \"numeric\"\n      })]\n    }), _jsx(TouchableOpacity, {\n      style: styles.buttonstyle,\n      onPress: Handler,\n      children: _jsx(Text, {\n        style: styles.buttontext,\n        children: \"Pay\"\n      })\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#5390d9\",\n    textAlign: \"center\",\n    paddingHorizontal: 50\n  },\n  screen: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    paddingHorizontal: 80,\n    paddingTop: 100,\n    paddingBottom: 50\n  },\n  image: {\n    width: 100,\n    height: 100,\n    borderRadius: 50\n  },\n  input: {\n    height: 40,\n    color: \"rgb(255, 255, 255)\",\n    borderBottomColor: \"#cae9ff\",\n    borderBottomWidth: 4\n  },\n  buttonstyle: {\n    backgroundColor: \"#f2e9e4\",\n    width: \"100%\",\n    padding: 15,\n    borderRadius: 10,\n    alignItems: \"center\"\n  },\n  buttontext: {\n    color: \"#FFF\",\n    fontWeight: \"700\",\n    fontSize: 16\n  },\n  format: {\n    paddingBottom: 20\n  }\n});","map":{"version":3,"sources":["C:/Users/mahmo/OneDrive/Desktop/CS303-Project(New)/Pages/Payment.jsx"],"names":["React","useState","useEffect","Logo","deleteFStadium","getFStadium","getUserUId","addUsersToDocuments","updateFootball","test","getUsers","updateUser","getBStadium","getTStadium","Payment","navigation","route","currentUserId","name","setName","cardnumber","setCardNumber","cvv","setCVV","date","setDate","Fstadium","setFStadium","Bstadium","setBStadium","Tstadium","setTStadium","currentFStadPrice","currentBStadPrice","currentTStadPrice","stadName","params","then","userId","data","Handler","console","log","i","length","price","users","id","j","undefined","balance","state","alert","pop","goBack","updateBasketball","updateTennis","styles","container","screen","image","format","input","buttonstyle","buttontext","StyleSheet","create","flex","backgroundColor","textAlign","paddingHorizontal","justifyContent","alignItems","paddingTop","paddingBottom","width","height","borderRadius","color","borderBottomColor","borderBottomWidth","padding","fontWeight","fontSize"],"mappings":"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","sourcesContent":["import {\r\n  TouchableOpacity,\r\n  StyleSheet,\r\n  Text,\r\n  View,\r\n  Image,\r\n  Button,\r\n  TextInput,\r\n} from \"react-native\";\r\nimport React, { useState, useEffect } from \"react\";\r\n\r\nimport Logo from \"../assets/2511582.jpg\";\r\nimport { deleteFStadium, getFStadium } from \"../db/Stadium/Football\";\r\nimport { getUserUId } from \"../db/Auth\";\r\nimport {addUsersToDocuments, updateFootball, test, getUsers,updateUser} from \"../db/User\";\r\nimport { getBStadium } from \"../db/Stadium/Basketball\";\r\nimport { getTStadium } from \"../db/Stadium/Tennis\";\r\n\r\nexport default function Payment({ navigation, route }) {\r\n  let currentUserId;\r\n  const [name, setName] = useState(\"\");\r\n  const [cardnumber, setCardNumber] = useState(\"\");\r\n  const [cvv, setCVV] = useState(\"\");\r\n  const [date, setDate] = useState(\"\");\r\n  const [Fstadium, setFStadium] = useState([]);\r\n  const [Bstadium, setBStadium] = useState([]);\r\n  const [Tstadium, setTStadium] = useState([]);\r\n  // const [currentUserBalance,setCurrentUserBalance] = useState();\r\n  let currentFStadPrice;\r\n  let currentBStadPrice;\r\n  let currentTStadPrice;\r\n  let {stadName} = route.params;\r\n\r\n  // console.log(user)\r\n\r\n  // console.log(stadium);\r\n\r\n  // set currentUserId with userId\r\n  useEffect(()=>{\r\n    getUserUId().then((userId)=>{\r\n      currentUserId = userId;\r\n    })\r\n  },[]);\r\n\r\n  useEffect(() => {\r\n    getFStadium().then((data) => {\r\n      setFStadium(data);\r\n    })\r\n  },[]);\r\n\r\n\r\n  useEffect(() => {\r\n    getBStadium().then((data) => {\r\n      setBStadium(data);\r\n    })\r\n  },[]);\r\n\r\n\r\n  useEffect(() => {\r\n    getTStadium().then((data) => {\r\n      setTStadium(data);\r\n    })\r\n  },[]);\r\n\r\n  const Handler = () => {\r\n    /*Handle Football*/\r\n    console.log(\"here in paymethod\")\r\n    //get currentFStadPrice\r\n    getFStadium().then((data) => {\r\n      for (let i = 0; i < data.length; i++) {\r\n        if (data[i].name === stadName) {\r\n          console.log(\"Fstad name in db is \" + data[i].name)\r\n          console.log(\"Fstad price in db is \" + data[i].price)\r\n          currentFStadPrice = data[i].price\r\n          console.log(\"Fstad price locally is \" + currentFStadPrice)\r\n        }\r\n      }\r\n    })\r\n\r\n    getBStadium().then((data) => {\r\n      for (let i = 0; i < data.length; i++) {\r\n        if (data[i].name === stadName) {\r\n          console.log(\"Bstad name in db is \" + data[i].name)\r\n          console.log(\"Bstad price in db is \" + data[i].price)\r\n          currentBStadPrice = data[i].price\r\n          console.log(\"Bstad price locally is \" + currentFStadPrice)\r\n        }\r\n      }\r\n    })\r\n\r\n    getTStadium().then((data) => {\r\n      for (let i = 0; i < data.length; i++) {\r\n        if (data[i].name === stadName) {\r\n          console.log(\"Tstad name in db is \" + data[i].name)\r\n          console.log(\"Tstad price in db is \" + data[i].price)\r\n          currentTStadPrice = data[i].price\r\n          console.log(\"Tstad price locally is \" + currentFStadPrice)\r\n        }\r\n      }\r\n    })\r\n\r\n    //update current user balance\r\n    getUsers().then((users) => {\r\n      getUserUId().then((userId) => {\r\n        console.log(\"inside getUsers()\")\r\n        console.log(users)\r\n        for (let i = 0; i < users.length; i++) {\r\n          console.log(\"should be printed\" + users.length + \" times\")\r\n          if (userId == users[i].id) {\r\n            console.log(\"userId == users[i].id is true\")\r\n            for (let j = 0; j < Fstadium.length; j++) {\r\n              if (Fstadium[j].name !== undefined) {   //to remove error \"Uncaught (in promise) TypeError: Cannot read properties of undefined (reading 'name')\"\r\n                if (stadName === Fstadium[j].name) {\r\n                  if (currentFStadPrice > users[i].balance) {\r\n                    console.log(\"Fstadium[j] before pop\",Fstadium[j].state)\r\n                    alert(\"you dont have enough money\") // ASK doc -> not working\r\n                    Fstadium[j].state.pop();\r\n                    console.log(\"Fstadium[j] after pop\",Fstadium[j].state)\r\n                    updateFootball(Fstadium[i]);\r\n                    navigation.goBack();\r\n                    break;\r\n                  } else {\r\n                    console.log(\"currentFStadPrice is : \",currentFStadPrice)\r\n                    console.log(\"users[i].balance is : \",users[i].balance)\r\n                    users[i].balance = users[i].balance - currentFStadPrice;\r\n                    updateUser(users[i]).then(() => alert(\"user's balance has been updated\"));\r\n                    navigation.goBack();\r\n                  }\r\n                }\r\n              } else if (stadName === Bstadium[i].name) {\r\n                if (currentBStadPrice > users[i].balance) {\r\n                  alert(\"you dont have enough money\")\r\n                  Bstadium[j].state.pop();\r\n                  updateBasketball(Bstadium[j]);\r\n                  navigation.goBack();\r\n                  break;\r\n                } else {\r\n                  console.log(currentBStadPrice)\r\n                  users[i].balance = users[i].balance - currentBStadPrice;\r\n                  updateUser(users[i]).then(() => alert(\"user's balance has been updated\"));\r\n                  navigation.goBack();\r\n                }\r\n              } else if (stadName === Tstadium[j].name) {\r\n                if (currentTStadPrice > users[i].balance) {\r\n                  alert(\"you dont have enough money\")\r\n                  Tstadium[j].state.pop();\r\n                  updateTennis(Tstadium[j]);\r\n                  navigation.goBack();\r\n                  break;\r\n                } else {\r\n                  console.log(currentTStadPrice)\r\n                  users[i].balance = users[i].balance - currentTStadPrice;\r\n                  updateUser(users[i]).then(() => alert(\"user's balance has been updated\"));\r\n                  navigation.goBack();\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.screen}>\r\n        <Image source={Logo} style={styles.image} />\r\n      </View>\r\n      <View style={styles.format}>\r\n        <TextInput\r\n          style={styles.input}\r\n          placeholder=\"Card Name\"\r\n          onChangeText={setName}\r\n          keyboardType=\"default\"\r\n        />\r\n        <TextInput\r\n          style={styles.input}\r\n          placeholder=\"Card Number\"\r\n          onChangeText={setCardNumber}\r\n          keyboardType=\"numeric\"\r\n        />\r\n        <TextInput\r\n          style={styles.input}\r\n          placeholder=\"MM/YY\"\r\n          onChangeText={setDate}\r\n          keyboardType=\"default\"\r\n        />\r\n        <TextInput\r\n          style={styles.input}\r\n          placeholder=\"CVV\"\r\n          onChangeText={setCVV}\r\n          keyboardType=\"numeric\"\r\n        />\r\n      </View>\r\n      <TouchableOpacity style={styles.buttonstyle} onPress={Handler}>\r\n        <Text style={styles.buttontext}>Pay</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: \"#5390d9\",\r\n    textAlign: \"center\",\r\n    paddingHorizontal: 50,\r\n  },\r\n  screen: {\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    paddingHorizontal: 80,\r\n    paddingTop: 100,\r\n    paddingBottom: 50,\r\n  },\r\n  image: {\r\n    width: 100,\r\n    height: 100,\r\n    borderRadius: 50,\r\n  },\r\n  input: {\r\n    height: 40,\r\n    color: \"rgb(255, 255, 255)\",\r\n    borderBottomColor: \"#cae9ff\",\r\n    borderBottomWidth: 4,\r\n  },\r\n  buttonstyle: {\r\n    backgroundColor: \"#f2e9e4\",\r\n    width: \"100%\",\r\n    padding: 15,\r\n    borderRadius: 10,\r\n    alignItems: \"center\",\r\n  },\r\n  buttontext: {\r\n    color: \"#FFF\",\r\n    fontWeight: \"700\",\r\n    fontSize: 16,\r\n  },\r\n  format: {\r\n    paddingBottom: 20,\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}