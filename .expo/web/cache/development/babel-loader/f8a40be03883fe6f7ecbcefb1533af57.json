{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport React, { useState, useEffect } from \"react\";\nimport Logo from \"../assets/2511582.jpg\";\nimport { deleteFStadium, getFStadium } from \"../db/Stadium/Football\";\nimport { getUserUId } from \"../db/Auth\";\nimport { addUsersToDocuments, updateFootball, test, getUsers, updateUser } from \"../db/User\";\nimport { getBStadium } from \"../db/Stadium/Basketball\";\nimport { getTStadium } from \"../db/Stadium/Tennis\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Payment(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n  var currentUserId;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      Fstadium = _useState2[0],\n      setFStadium = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      Bstadium = _useState4[0],\n      setBStadium = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      Tstadium = _useState6[0],\n      setTStadium = _useState6[1];\n\n  var currentFStadPrice;\n  var currentBStadPrice;\n  var currentTStadPrice;\n  var _route$params = route.params,\n      id = _route$params.id,\n      stadName = _route$params.stadName,\n      day = _route$params.day,\n      stDate = _route$params.stDate,\n      edDate = _route$params.edDate;\n  useEffect(function () {\n    getUserUId().then(function (userId) {\n      currentUserId = userId;\n    });\n  }, []);\n  useEffect(function () {\n    getFStadium().then(function (data) {\n      setFStadium(data);\n    });\n  }, []);\n  useEffect(function () {\n    getBStadium().then(function (data) {\n      setBStadium(data);\n    });\n  }, []);\n  useEffect(function () {\n    getTStadium().then(function (data) {\n      setTStadium(data);\n    });\n  }, []);\n\n  var Handler = function Handler() {\n    console.log(\"here in paymethod\");\n    getFStadium().then(function (data) {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].name === stadName) {\n          console.log(\"Fstad name in db is \" + data[i].name);\n          console.log(\"Fstad price in db is \" + data[i].price);\n          currentFStadPrice = data[i].price;\n          console.log(\"Fstad price locally is \" + currentFStadPrice);\n        }\n      }\n    });\n    getBStadium().then(function (data) {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].name === stadName) {\n          console.log(\"Bstad name in db is \" + data[i].name);\n          console.log(\"Bstad price in db is \" + data[i].price);\n          currentBStadPrice = data[i].price;\n          console.log(\"Bstad price locally is \" + currentBStadPrice);\n        }\n      }\n    });\n    getTStadium().then(function (data) {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].name === stadName) {\n          console.log(\"Tstad name in db is \" + data[i].name);\n          console.log(\"Tstad price in db is \" + data[i].price);\n          currentTStadPrice = data[i].price;\n          console.log(\"Tstad price locally is \" + currentTStadPrice);\n        }\n      }\n    });\n    getUsers().then(function (users) {\n      getUserUId().then(function (userId) {\n        console.log(\"inside getUsers()\");\n        console.log(users);\n\n        for (var i = 0; i < users.length; i++) {\n          console.log(\"should be printed\" + users.length + \" times\");\n\n          if (userId == users[i].id) {\n            console.log(\"userId == users[i].id is true\");\n\n            for (var j = 0; j < Fstadium.length; j++) {\n              if (Fstadium[j].name !== undefined) {\n                if (stadName === Fstadium[j].name) {\n                  if (currentFStadPrice > users[i].balance) {\n                    console.log(\"Fstadium[j] before pop\", Fstadium[j].state);\n                    alert(\"you dont have enough money\");\n                    navigation.goBack();\n                    break;\n                  } else {\n                    console.log(\"currentFStadPrice is : \", currentFStadPrice);\n                    console.log(\"users[i].balance is : \", users[i].balance);\n                    users[i].balance = users[i].balance - currentFStadPrice;\n                    Fstadium[j].state.push({\n                      id: id,\n                      day: day,\n                      stDate: stDate,\n                      edDate: edDate\n                    });\n                    updateFootball(Fstadium[j]);\n                    updateUser(users[i]).then(function () {\n                      return alert(\"user's balance has been updated\");\n                    });\n                    navigation.navigate('Home');\n                  }\n                }\n              } else if (stadName === Bstadium[i].name) {\n                if (currentBStadPrice > users[i].balance) {\n                  alert(\"you dont have enough money\");\n                  Bstadium[j].state.pop();\n                  updateBasketball(Bstadium[j]);\n                  navigation.goBack();\n                  break;\n                } else {\n                  console.log(currentBStadPrice);\n                  users[i].balance = users[i].balance - currentBStadPrice;\n                  updateUser(users[i]).then(function () {\n                    return alert(\"user's balance has been updated\");\n                  });\n                  navigation.goBack();\n                }\n              } else if (stadName === Tstadium[j].name) {\n                if (currentTStadPrice > users[i].balance) {\n                  alert(\"you dont have enough money\");\n                  Tstadium[j].state.pop();\n                  updateTennis(Tstadium[j]);\n                  navigation.goBack();\n                  break;\n                } else {\n                  console.log(currentTStadPrice);\n                  users[i].balance = users[i].balance - currentTStadPrice;\n                  updateUser(users[i]).then(function () {\n                    return alert(\"user's balance has been updated\");\n                  });\n                  navigation.goBack();\n                }\n              }\n            }\n          }\n        }\n      });\n    });\n  };\n\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(View, {\n      style: styles.screen,\n      children: _jsx(Image, {\n        source: Logo,\n        style: styles.image\n      })\n    }), _jsx(TouchableOpacity, {\n      style: styles.buttonstyle,\n      onPress: Handler,\n      children: _jsx(Text, {\n        style: styles.buttontext,\n        children: \"Pay\"\n      })\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#5390d9\",\n    textAlign: \"center\",\n    paddingHorizontal: 50\n  },\n  screen: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    paddingHorizontal: 80,\n    paddingTop: 100,\n    paddingBottom: 50\n  },\n  image: {\n    width: 100,\n    height: 100,\n    borderRadius: 50\n  },\n  input: {\n    height: 40,\n    color: \"rgb(255, 255, 255)\",\n    borderBottomColor: \"#cae9ff\",\n    borderBottomWidth: 4\n  },\n  buttonstyle: {\n    backgroundColor: \"#f2e9e4\",\n    width: \"100%\",\n    padding: 15,\n    borderRadius: 10,\n    alignItems: \"center\"\n  },\n  buttontext: {\n    color: \"#FFF\",\n    fontWeight: \"700\",\n    fontSize: 16\n  },\n  format: {\n    paddingBottom: 20\n  }\n});","map":{"version":3,"sources":["C:/Users/mahmo/OneDrive/Desktop/CS303-Project(New)/Pages/Payment.jsx"],"names":["React","useState","useEffect","Logo","deleteFStadium","getFStadium","getUserUId","addUsersToDocuments","updateFootball","test","getUsers","updateUser","getBStadium","getTStadium","Payment","navigation","route","currentUserId","Fstadium","setFStadium","Bstadium","setBStadium","Tstadium","setTStadium","currentFStadPrice","currentBStadPrice","currentTStadPrice","params","id","stadName","day","stDate","edDate","then","userId","data","Handler","console","log","i","length","name","price","users","j","undefined","balance","state","alert","goBack","push","navigate","pop","updateBasketball","updateTennis","styles","container","screen","image","buttonstyle","buttontext","StyleSheet","create","flex","backgroundColor","textAlign","paddingHorizontal","justifyContent","alignItems","paddingTop","paddingBottom","width","height","borderRadius","input","color","borderBottomColor","borderBottomWidth","padding","fontWeight","fontSize","format"],"mappings":"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","sourcesContent":["import {\r\n  TouchableOpacity,\r\n  StyleSheet,\r\n  Text,\r\n  View,\r\n  Image,\r\n  Button,\r\n  TextInput,\r\n} from \"react-native\";\r\nimport React, { useState, useEffect } from \"react\";\r\n\r\nimport Logo from \"../assets/2511582.jpg\";\r\nimport { deleteFStadium, getFStadium } from \"../db/Stadium/Football\";\r\nimport { getUserUId } from \"../db/Auth\";\r\nimport {addUsersToDocuments, updateFootball, test, getUsers,updateUser} from \"../db/User\";\r\nimport { getBStadium } from \"../db/Stadium/Basketball\";\r\nimport { getTStadium } from \"../db/Stadium/Tennis\";\r\n\r\nexport default function Payment({ navigation, route }) {\r\n  let currentUserId;\r\n  const [Fstadium, setFStadium] = useState([]);\r\n  const [Bstadium, setBStadium] = useState([]);\r\n  const [Tstadium, setTStadium] = useState([]);\r\n  // const [currentUserBalance,setCurrentUserBalance] = useState();\r\n  let currentFStadPrice;\r\n  let currentBStadPrice;\r\n  let currentTStadPrice;\r\n  let {id:id,stadName:stadName,day:day,stDate:stDate,edDate:edDate,} = route.params;\r\n\r\n  // console.log(user)\r\n\r\n  // console.log(stadium);\r\n\r\n  // set currentUserId with userId\r\n  useEffect(()=>{\r\n    getUserUId().then((userId)=>{\r\n      currentUserId = userId;\r\n    })\r\n  },[]);\r\n\r\n  useEffect(() => {\r\n    getFStadium().then((data) => {\r\n      setFStadium(data);\r\n    })\r\n  },[]);\r\n\r\n\r\n  useEffect(() => {\r\n    getBStadium().then((data) => {\r\n      setBStadium(data);\r\n    })\r\n  },[]);\r\n\r\n\r\n  useEffect(() => {\r\n    getTStadium().then((data) => {\r\n      setTStadium(data);\r\n    })\r\n  },[]);\r\n\r\n  const Handler = () => {\r\n    /*Handle Football*/\r\n    console.log(\"here in paymethod\")\r\n    //get currentFStadPrice\r\n    getFStadium().then((data) => {\r\n      for (let i = 0; i < data.length; i++) {\r\n        if (data[i].name === stadName) {\r\n          console.log(\"Fstad name in db is \" + data[i].name)\r\n          console.log(\"Fstad price in db is \" + data[i].price)\r\n          currentFStadPrice = data[i].price\r\n          console.log(\"Fstad price locally is \" + currentFStadPrice)\r\n        }\r\n      }\r\n    })\r\n\r\n\r\n\r\n    getBStadium().then((data) => {\r\n      for (let i = 0; i < data.length; i++) {\r\n        if (data[i].name === stadName) {\r\n          console.log(\"Bstad name in db is \" + data[i].name)\r\n          console.log(\"Bstad price in db is \" + data[i].price)\r\n          currentBStadPrice = data[i].price\r\n          console.log(\"Bstad price locally is \" + currentBStadPrice)\r\n        }\r\n      }\r\n    })\r\n\r\n\r\n\r\n    getTStadium().then((data) => {\r\n      for (let i = 0; i < data.length; i++) {\r\n        if (data[i].name === stadName) {\r\n          console.log(\"Tstad name in db is \" + data[i].name)\r\n          console.log(\"Tstad price in db is \" + data[i].price)\r\n          currentTStadPrice = data[i].price\r\n          console.log(\"Tstad price locally is \" + currentTStadPrice)\r\n        }\r\n      }\r\n    })\r\n\r\n    //update current user balance\r\n    getUsers().then((users) => {\r\n      getUserUId().then((userId) => {\r\n        console.log(\"inside getUsers()\")\r\n        console.log(users)\r\n        for (let i = 0; i < users.length; i++) {\r\n          console.log(\"should be printed\" + users.length + \" times\")\r\n          if (userId == users[i].id) {\r\n            console.log(\"userId == users[i].id is true\")\r\n            for (let j = 0; j < Fstadium.length; j++) {\r\n              if (Fstadium[j].name !== undefined) {   //to remove error \"Uncaught (in promise) TypeError: Cannot read properties of undefined (reading 'name')\"\r\n                if (stadName === Fstadium[j].name) {\r\n                  if (currentFStadPrice > users[i].balance) {\r\n                    console.log(\"Fstadium[j] before pop\",Fstadium[j].state)\r\n                    alert(\"you dont have enough money\") // ASK doc -> not working\r\n                    // Fstadium[j].state.pop();\r\n                    // console.log(\"Fstadium[j] after pop\",Fstadium[j].state)\r\n                    // updateFootball(Fstadium[i]);\r\n                    navigation.goBack();\r\n                    break;\r\n                  } else {\r\n                    console.log(\"currentFStadPrice is : \",currentFStadPrice)\r\n                    console.log(\"users[i].balance is : \",users[i].balance)\r\n                    users[i].balance = users[i].balance - currentFStadPrice;\r\n                    Fstadium[j].state.push({id,day,stDate,edDate})\r\n                    updateFootball(Fstadium[j]) //update date in state\r\n                    updateUser(users[i]).then(() => alert(\"user's balance has been updated\")); //update balance\r\n                    navigation.navigate('Home');\r\n                  }\r\n                }\r\n\r\n\r\n              } else if (stadName === Bstadium[i].name) {\r\n                if (currentBStadPrice > users[i].balance) {\r\n                  alert(\"you dont have enough money\")\r\n                  Bstadium[j].state.pop();\r\n                  updateBasketball(Bstadium[j]);\r\n                  navigation.goBack();\r\n                  break;\r\n                } else {\r\n                  console.log(currentBStadPrice)\r\n                  users[i].balance = users[i].balance - currentBStadPrice;\r\n                  updateUser(users[i]).then(() => alert(\"user's balance has been updated\"));\r\n                  navigation.goBack();\r\n                }\r\n              } else if (stadName === Tstadium[j].name) {\r\n                if (currentTStadPrice > users[i].balance) {\r\n                  alert(\"you dont have enough money\")\r\n                  Tstadium[j].state.pop();\r\n                  updateTennis(Tstadium[j]);\r\n                  navigation.goBack();\r\n                  break;\r\n                } else {\r\n                  console.log(currentTStadPrice)\r\n                  users[i].balance = users[i].balance - currentTStadPrice;\r\n                  updateUser(users[i]).then(() => alert(\"user's balance has been updated\"));\r\n                  navigation.goBack();\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      })\r\n    })\r\n  }\r\n  return (\r\n\r\n    <View style={styles.container}>\r\n      <View style={styles.screen}>\r\n        <Image source={Logo} style={styles.image} />\r\n      </View>\r\n      <TouchableOpacity style={styles.buttonstyle} onPress={Handler}>\r\n        <Text style={styles.buttontext}>Pay</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: \"#5390d9\",\r\n    textAlign: \"center\",\r\n    paddingHorizontal: 50,\r\n  },\r\n  screen: {\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    paddingHorizontal: 80,\r\n    paddingTop: 100,\r\n    paddingBottom: 50,\r\n  },\r\n  image: {\r\n    width: 100,\r\n    height: 100,\r\n    borderRadius: 50,\r\n  },\r\n  input: {\r\n    height: 40,\r\n    color: \"rgb(255, 255, 255)\",\r\n    borderBottomColor: \"#cae9ff\",\r\n    borderBottomWidth: 4,\r\n  },\r\n  buttonstyle: {\r\n    backgroundColor: \"#f2e9e4\",\r\n    width: \"100%\",\r\n    padding: 15,\r\n    borderRadius: 10,\r\n    alignItems: \"center\",\r\n  },\r\n  buttontext: {\r\n    color: \"#FFF\",\r\n    fontWeight: \"700\",\r\n    fontSize: 16,\r\n  },\r\n  format: {\r\n    paddingBottom: 20,\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}