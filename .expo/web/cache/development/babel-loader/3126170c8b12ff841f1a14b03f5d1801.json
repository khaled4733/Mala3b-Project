{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport React, { useState, useEffect } from \"react\";\nimport Logo from \"../assets/2511582.jpg\";\nimport { deleteFStadium, getFStadium } from \"../db/Stadium/Football\";\nimport { getUserUId } from \"../db/Auth\";\nimport { addUsersToDocuments, updateFootball, test, getUsers, updateUser, updateBasketball, updateTennis } from \"../db/User\";\nimport { getBStadium } from \"../db/Stadium/Basketball\";\nimport { getTStadium } from \"../db/Stadium/Tennis\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Payment(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n  var currentUserId;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      Fstadium = _useState2[0],\n      setFStadium = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      Bstadium = _useState4[0],\n      setBStadium = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      Tstadium = _useState6[0],\n      setTStadium = _useState6[1];\n\n  var currentFStadPrice;\n  var currentBStadPrice;\n  var currentTStadPrice;\n  var _route$params = route.params,\n      id = _route$params.id,\n      stadName = _route$params.stadName,\n      day = _route$params.day,\n      stDate = _route$params.stDate,\n      edDate = _route$params.edDate;\n  useEffect(function () {\n    getUserUId().then(function (userId) {\n      currentUserId = userId;\n    });\n  }, []);\n  useEffect(function () {\n    getFStadium().then(function (data) {\n      setFStadium(data);\n    });\n  }, []);\n  useEffect(function () {\n    getBStadium().then(function (data) {\n      setBStadium(data);\n    });\n  }, []);\n  useEffect(function () {\n    getTStadium().then(function (data) {\n      setTStadium(data);\n    });\n  }, []);\n\n  var Handler = function Handler() {\n    console.log(\"here in paymethod\");\n    getFStadium().then(function (data) {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].name === stadName) {\n          console.log(\"Fstad name in db is \" + data[i].name);\n          console.log(\"Fstad price in db is \" + data[i].price);\n          currentFStadPrice = data[i].price;\n          console.log(\"Fstad price locally is \" + currentFStadPrice);\n        }\n      }\n    });\n    getBStadium().then(function (data) {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].name === stadName) {\n          console.log(\"Bstad name in db is \" + data[i].name);\n          console.log(\"Bstad price in db is \" + data[i].price);\n          currentBStadPrice = data[i].price;\n          console.log(\"Bstad price locally is \" + currentBStadPrice);\n        }\n      }\n    });\n    getTStadium().then(function (data) {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].name === stadName) {\n          console.log(\"Tstad name in db is \" + data[i].name);\n          console.log(\"Tstad price in db is \" + data[i].price);\n          currentTStadPrice = data[i].price;\n          console.log(\"Tstad price locally is \" + currentTStadPrice);\n        }\n      }\n    });\n    getUsers().then(function (users) {\n      getUserUId().then(function (userId) {\n        console.log(\"inside getUsers()\");\n        console.log(users);\n\n        for (var i = 0; i < users.length; i++) {\n          console.log(\"should be printed\" + users.length + \" times\");\n\n          if (userId == users[i].id) {\n            console.log(\"userId == users[i].id is true\");\n\n            for (var j = 0; j < Fstadium.length; j++) {\n              if (Fstadium[j].name !== undefined) {\n                if (stadName === Fstadium[j].name) {\n                  if (currentFStadPrice > users[i].balance) {\n                    console.log(\"Fstadium[j] before pop\", Fstadium[j].state);\n                    alert(\"you dont have enough money\");\n                    navigation.goBack();\n                    break;\n                  } else {\n                    console.log(\"currentFStadPrice is : \", currentFStadPrice);\n                    console.log(\"users[i].balance is : \", users[i].balance);\n                    users[i].balance = users[i].balance - currentFStadPrice;\n                    Fstadium[j].state.push({\n                      id: id,\n                      day: day,\n                      stDate: stDate,\n                      edDate: edDate\n                    });\n                    updateFootball(Fstadium[j]);\n                    updateUser(users[i]).then(function () {\n                      return alert(\"user's balance has been updated\");\n                    });\n                    navigation.navigate(\"Home\");\n                  }\n                }\n              } else if (stadName === Bstadium[i].name) {\n                if (currentBStadPrice > users[i].balance) {\n                  alert(\"you dont have enough money\");\n                  navigation.goBack();\n                  break;\n                } else {\n                  console.log(currentBStadPrice);\n                  users[i].balance = users[i].balance - currentBStadPrice;\n                  Bstadium[j].state.push({\n                    id: id,\n                    day: day,\n                    stDate: stDate,\n                    edDate: edDate\n                  });\n                  updateBasketball(Bstadium[j]);\n                  updateUser(users[i]).then(function () {\n                    return alert(\"user's balance has been updated\");\n                  });\n                  navigation.navigate(\"Home\");\n                }\n              } else if (stadName === Tstadium[j].name) {\n                if (currentTStadPrice > users[i].balance) {\n                  alert(\"you dont have enough money\");\n                  navigation.goBack();\n                  break;\n                } else {\n                  console.log(currentTStadPrice);\n                  users[i].balance = users[i].balance - currentTStadPrice;\n                  Tstadium[j].state.push({\n                    id: id,\n                    day: day,\n                    stDate: stDate,\n                    edDate: edDate\n                  });\n                  updateTennis(Tstadium[j]);\n                  updateUser(users[i]).then(function () {\n                    return alert(\"user's balance has been updated\");\n                  });\n                  navigation.navigate(\"Home\");\n                }\n              }\n            }\n          }\n        }\n      });\n    });\n  };\n\n  return _jsx(View, {\n    style: styles.container,\n    children: _jsxs(View, {\n      style: styles.component,\n      children: [_jsx(Image, {\n        source: Logo,\n        style: styles.image\n      }), _jsx(TouchableOpacity, {\n        style: styles.button,\n        onPress: Handler,\n        children: _jsx(Text, {\n          style: styles.buttontext,\n          children: \"Pay\"\n        })\n      })]\n    })\n  });\n}\nvar cardwidth = Math.round(Dimensions.get(\"window\").width);\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    backgroundColor: \"#f2e9e4\"\n  },\n  component: {\n    backgroundColor: \"#22223b\",\n    borderRadius: 20,\n    width: cardwidth - 100,\n    height: 500,\n    paddingHorizontal: 25,\n    marginVertical: 15,\n    justifyContent: \"center\",\n    shadowColor: \"#000000\",\n    shadowOffset: {\n      width: 5,\n      height: 5\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 3\n  },\n  screen: {\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    paddingHorizontal: 80,\n    paddingTop: 100,\n    paddingBottom: 50\n  },\n  image: {\n    width: 100,\n    height: 100,\n    borderRadius: 50,\n    marginBottom: 20\n  },\n  buttontext: {\n    color: \"#22223b\",\n    fontSize: 15,\n    fontWeight: \"500\"\n  },\n  button: {\n    backgroundColor: \"#f2e9e4\",\n    marginTop: 20,\n    width: 120,\n    height: 50,\n    borderRadius: 10,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  }\n});","map":{"version":3,"sources":["D:/Mal3ab-Project1/Pages/Payment.jsx"],"names":["React","useState","useEffect","Logo","deleteFStadium","getFStadium","getUserUId","addUsersToDocuments","updateFootball","test","getUsers","updateUser","updateBasketball","updateTennis","getBStadium","getTStadium","Payment","navigation","route","currentUserId","Fstadium","setFStadium","Bstadium","setBStadium","Tstadium","setTStadium","currentFStadPrice","currentBStadPrice","currentTStadPrice","params","id","stadName","day","stDate","edDate","then","userId","data","Handler","console","log","i","length","name","price","users","j","undefined","balance","state","alert","goBack","push","navigate","styles","container","component","image","button","buttontext","cardwidth","Math","round","Dimensions","get","width","StyleSheet","create","flex","alignItems","justifyContent","backgroundColor","borderRadius","height","paddingHorizontal","marginVertical","shadowColor","shadowOffset","shadowOpacity","shadowRadius","screen","paddingTop","paddingBottom","marginBottom","color","fontSize","fontWeight","marginTop"],"mappings":"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","sourcesContent":["import {\r\n  TouchableOpacity,\r\n  StyleSheet,\r\n  Text,\r\n  View,\r\n  Image,\r\n  Button,\r\n  TextInput,\r\n  Dimensions,\r\n} from \"react-native\";\r\nimport React, { useState, useEffect } from \"react\";\r\n\r\nimport Logo from \"../assets/2511582.jpg\";\r\nimport { deleteFStadium, getFStadium } from \"../db/Stadium/Football\";\r\nimport { getUserUId } from \"../db/Auth\";\r\nimport {\r\n  addUsersToDocuments,\r\n  updateFootball,\r\n  test,\r\n  getUsers,\r\n  updateUser,\r\n  updateBasketball,\r\n  updateTennis,\r\n} from \"../db/User\";\r\nimport { getBStadium } from \"../db/Stadium/Basketball\";\r\nimport { getTStadium } from \"../db/Stadium/Tennis\";\r\n\r\nexport default function Payment({ navigation, route }) {\r\n  let currentUserId;\r\n  const [Fstadium, setFStadium] = useState([]);\r\n  const [Bstadium, setBStadium] = useState([]);\r\n  const [Tstadium, setTStadium] = useState([]);\r\n  // const [currentUserBalance,setCurrentUserBalance] = useState();\r\n  let currentFStadPrice;\r\n  let currentBStadPrice;\r\n  let currentTStadPrice;\r\n  let {\r\n    id: id,\r\n    stadName: stadName,\r\n    day: day,\r\n    stDate: stDate,\r\n    edDate: edDate,\r\n  } = route.params;\r\n\r\n  // console.log(user)\r\n\r\n  // console.log(stadium);\r\n\r\n  // set currentUserId with userId\r\n  useEffect(() => {\r\n    getUserUId().then((userId) => {\r\n      currentUserId = userId;\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    getFStadium().then((data) => {\r\n      setFStadium(data);\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    getBStadium().then((data) => {\r\n      setBStadium(data);\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    getTStadium().then((data) => {\r\n      setTStadium(data);\r\n    });\r\n  }, []);\r\n\r\n  const Handler = () => {\r\n    /*Handle Football*/\r\n    console.log(\"here in paymethod\");\r\n    //get currentFStadPrice\r\n    getFStadium().then((data) => {\r\n      for (let i = 0; i < data.length; i++) {\r\n        if (data[i].name === stadName) {\r\n          console.log(\"Fstad name in db is \" + data[i].name);\r\n          console.log(\"Fstad price in db is \" + data[i].price);\r\n          currentFStadPrice = data[i].price;\r\n          console.log(\"Fstad price locally is \" + currentFStadPrice);\r\n        }\r\n      }\r\n    });\r\n\r\n    getBStadium().then((data) => {\r\n      for (let i = 0; i < data.length; i++) {\r\n        if (data[i].name === stadName) {\r\n          console.log(\"Bstad name in db is \" + data[i].name);\r\n          console.log(\"Bstad price in db is \" + data[i].price);\r\n          currentBStadPrice = data[i].price;\r\n          console.log(\"Bstad price locally is \" + currentBStadPrice);\r\n        }\r\n      }\r\n    });\r\n\r\n    getTStadium().then((data) => {\r\n      for (let i = 0; i < data.length; i++) {\r\n        if (data[i].name === stadName) {\r\n          console.log(\"Tstad name in db is \" + data[i].name);\r\n          console.log(\"Tstad price in db is \" + data[i].price);\r\n          currentTStadPrice = data[i].price;\r\n          console.log(\"Tstad price locally is \" + currentTStadPrice);\r\n        }\r\n      }\r\n    });\r\n\r\n    //update current user balance\r\n    getUsers().then((users) => {\r\n      getUserUId().then((userId) => {\r\n        console.log(\"inside getUsers()\");\r\n        console.log(users);\r\n        for (let i = 0; i < users.length; i++) {\r\n          console.log(\"should be printed\" + users.length + \" times\");\r\n          if (userId == users[i].id) {\r\n            console.log(\"userId == users[i].id is true\");\r\n            for (let j = 0; j < Fstadium.length; j++) {\r\n              if (Fstadium[j].name !== undefined) {\r\n                //to remove error \"Uncaught (in promise) TypeError: Cannot read properties of undefined (reading 'name')\"\r\n                if (stadName === Fstadium[j].name) {\r\n                  if (currentFStadPrice > users[i].balance) {\r\n                    console.log(\"Fstadium[j] before pop\", Fstadium[j].state);\r\n                    alert(\"you dont have enough money\"); // ASK doc -> not working\r\n                    // Fstadium[j].state.pop();\r\n                    // console.log(\"Fstadium[j] after pop\",Fstadium[j].state)\r\n                    // updateFootball(Fstadium[i]);\r\n                    navigation.goBack();\r\n                    break;\r\n                  } else {\r\n                    console.log(\"currentFStadPrice is : \", currentFStadPrice);\r\n                    console.log(\"users[i].balance is : \", users[i].balance);\r\n                    users[i].balance = users[i].balance - currentFStadPrice;\r\n                    Fstadium[j].state.push({ id, day, stDate, edDate });\r\n                    updateFootball(Fstadium[j]); //update date in state\r\n                    updateUser(users[i]).then(() =>\r\n                      alert(\"user's balance has been updated\")\r\n                    ); //update balance\r\n                    navigation.navigate(\"Home\");\r\n                  }\r\n                }\r\n              } else if (stadName === Bstadium[i].name) {\r\n                if (currentBStadPrice > users[i].balance) {\r\n                  alert(\"you dont have enough money\");\r\n                  navigation.goBack();\r\n                  break;\r\n                } else {\r\n                  console.log(currentBStadPrice);\r\n                  users[i].balance = users[i].balance - currentBStadPrice;\r\n                  Bstadium[j].state.push({ id, day, stDate, edDate });\r\n                  updateBasketball(Bstadium[j]); //update date in state\r\n                  updateUser(users[i]).then(() =>\r\n                    alert(\"user's balance has been updated\")\r\n                  );\r\n                  navigation.navigate(\"Home\");\r\n                }\r\n              } else if (stadName === Tstadium[j].name) {\r\n                if (currentTStadPrice > users[i].balance) {\r\n                  alert(\"you dont have enough money\");\r\n                  navigation.goBack();\r\n                  break;\r\n                } else {\r\n                  console.log(currentTStadPrice);\r\n                  users[i].balance = users[i].balance - currentTStadPrice;\r\n                  Tstadium[j].state.push({ id, day, stDate, edDate });\r\n                  updateTennis(Tstadium[j]);\r\n                  updateUser(users[i]).then(() =>\r\n                    alert(\"user's balance has been updated\")\r\n                  );\r\n                  navigation.navigate(\"Home\");\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    });\r\n  };\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.component}>\r\n        <Image source={Logo} style={styles.image} />\r\n        <TouchableOpacity style={styles.button} onPress={Handler}>\r\n          <Text style={styles.buttontext}>Pay</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst cardwidth = Math.round(Dimensions.get(\"window\").width);\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    backgroundColor: \"#f2e9e4\",\r\n  },\r\n  component: {\r\n    backgroundColor: \"#22223b\",\r\n    borderRadius: 20,\r\n    width: cardwidth - 100,\r\n    height: 500,\r\n    paddingHorizontal: 25,\r\n    marginVertical: 15,\r\n    justifyContent: \"center\",\r\n    shadowColor: \"#000000\",\r\n    shadowOffset: {\r\n      width: 5,\r\n      height: 5,\r\n    },\r\n    shadowOpacity: 0.25,\r\n    shadowRadius: 3,\r\n  },\r\n  screen: {\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    paddingHorizontal: 80,\r\n    paddingTop: 100,\r\n    paddingBottom: 50,\r\n  },\r\n  image: {\r\n    width: 100,\r\n    height: 100,\r\n    borderRadius: 50,\r\n    marginBottom: 20,\r\n  },\r\n  buttontext: {\r\n    color: \"#22223b\",\r\n    fontSize: 15,\r\n    fontWeight: \"500\",\r\n  },\r\n  button: {\r\n    backgroundColor: \"#f2e9e4\",\r\n    marginTop: 20,\r\n    width: 120,\r\n    height: 50,\r\n    borderRadius: 10,\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}